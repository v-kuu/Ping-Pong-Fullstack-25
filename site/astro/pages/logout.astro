---
import Base from "@/astro/layouts/Base.astro";
import { SuccessCard } from "@/components/Card.tsx";
import { db, Sessions, eq } from "astro:db";

const user = Astro.locals.user;

if (user) {
  const sessionId = Astro.cookies.get("session")?.value;
  if (sessionId) {
    await db.delete(Sessions).where(eq(Sessions.id, sessionId));
    Astro.cookies.delete("session");
    Astro.locals.user = null;
  }
}
---

<Base title="Logged Out" active="/logout" favicon="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âœ¨</text></svg>" class="px-4 py-8 mx-auto min-h-screen flex items-center justify-center">
  <div class="w-full max-w-md">
    <SuccessCard
      title="Logged Out!"
      message="You have been successfully logged out."
      buttonText="Play Game"
      buttonHref="/game"
    />
  </div>
</Base>
